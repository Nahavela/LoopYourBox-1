<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <title>Local search app</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />
    <link href='/css/style.css' rel='stylesheet' />

    <link rel="stylesheet" href="/public/css/materialize.css">
</head>

<body>
    <div class="container">

        <div class="collection row" id="partnerList">
            <h2>List of Partners</h2>
            <% partnerInfo.forEach((partner) => { %>
            <a href="/partner/<%= partner._id %>" class="collection-item col s12"
                id="<%= partner._id %>"><%= partner.name %></a>
            <% }); %>
        </div>

        <div id='map'></div>
        
        <div class="row">
            <form action="">
                <div class="input-field col s12">
                    <select name="foodType" id="foodType">
                        <option value="all">Tous</option>
                        <% selectInfo.foodType.forEach(option => { 
                                        if (option==""){option = "Autres" }%>
                        <option value="<%= option %>"><%= option.charAt(0).toUpperCase() + option.slice(1) %></option>
                        <%})%>
                    </select>
                    <label for="foodType">Type de cuisine</label>
                </div>
                <div class="input-field col s12">
                    <select name="chain" id="chain">
                        <option value="all">Tous</option>
                        <% selectInfo.chain.forEach(option => { %>
                        <option value="<%= option %>"><%= option.charAt(0).toUpperCase() + option.slice(1) %></option>
                        <%})%>
                    </select>
                    <label for="chain">Cha√Æne</label>
                </div>
                <div class="input-field col s12">
                    <select name="postcode" id="postcode">
                        <option value="all">Tous</option>
                        <% selectInfo.postcode.forEach(option => { %>
                        <option value="<%= option %>"><%= option.charAt(0).toUpperCase() + option.slice(1) %></option>
                        <%})%>
                    </select>
                    <label for="postcode">Code postal</label>
                </div>
                <div class="input-field col s12">
                    <select name="city" id="city">
                        <option value="all">Tous</option>
                        <% selectInfo.city.forEach(option => { %>
                        <option value="<%= option %>"><%= option.charAt(0).toUpperCase() + option.slice(1) %></option>
                        <%})%>
                    </select>
                    <label for="city">Ville</label>
                </div>
                <div class="input-field col s12">
                    <select name="container" id="container">
                        <option value="all">Tous</option>
                        <option value="Plastique">Plastique </option>
                        <option value="Verre">Verre</option>
                        <option value="Inox">Inox</option>
                    </select>
                    <label for="container">Contenant</label>
                </div>
                <button class="col s12 waves-effect waves-light green darken-1 btn" href="/createpartner">Add
                    partner</button>
            </form>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="/public/js/bin/materialize.js"></script>
    <script>
        M.AutoInit();

        document.addEventListener('DOMContentLoaded', function () {
            var elems = document.querySelectorAll('select');
            var instances = M.FormSelect.init(elems, options);
        });
    </script>
    <script>
        let partnerInfo = <% - JSON.stringify(partnerInfo) %>;
    </script>
    <script src="/js/map.js"></script>
    <script src="/js/filterPartner.js"></script>

</body>

</html>